{"format_version":"1.1","terraform_version":"1.4.2","variables":{"account_assignments":{"value":{}},"permission_sets":{"value":{"AdministratorAccess":{"description":"Provides full access to AWS services and resources.","managed_policies":["arn:aws:iam::aws:policy/AdministratorAccess"],"session_duration":"PT2H"}}},"sso_groups":{"value":{}},"sso_users":{"value":{}}},"planned_values":{"outputs":{"account_assignment_data":{"sensitive":false,"type":["tuple",[]],"value":[]},"principals_and_assignments":{"sensitive":false,"type":["object",{}],"value":{}}},"root_module":{"resources":[{"address":"aws_ssoadmin_permission_set.pset[\"AdministratorAccess\"]","mode":"managed","type":"aws_ssoadmin_permission_set","name":"pset","index":"AdministratorAccess","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Provides full access to AWS services and resources.","instance_arn":"arn:aws:sso:::instance/ssoins-72236a571cf03aa7","name":"AdministratorAccess","relay_state":null,"session_duration":"PT2H","tags":null},"sensitive_values":{"tags_all":{}}}]}},"resource_changes":[{"address":"aws_ssoadmin_permission_set.pset[\"AdministratorAccess\"]","mode":"managed","type":"aws_ssoadmin_permission_set","name":"pset","index":"AdministratorAccess","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Provides full access to AWS services and resources.","instance_arn":"arn:aws:sso:::instance/ssoins-72236a571cf03aa7","name":"AdministratorAccess","relay_state":null,"session_duration":"PT2H","tags":null},"after_unknown":{"arn":true,"created_date":true,"id":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}}],"output_changes":{"account_assignment_data":{"actions":["create"],"before":null,"after":[],"after_unknown":false,"before_sensitive":false,"after_sensitive":false},"principals_and_assignments":{"actions":["create"],"before":null,"after":{},"after_unknown":false,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.4.2","values":{"outputs":{"account_assignment_data":{"sensitive":false,"value":[],"type":["tuple",[]]},"principals_and_assignments":{"sensitive":false,"value":{},"type":["object",{}]}},"root_module":{"resources":[{"address":"data.aws_ssoadmin_instances.sso_instance","mode":"data","type":"aws_ssoadmin_instances","name":"sso_instance","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arns":["arn:aws:sso:::instance/ssoins-72236a571cf03aa7"],"id":"us-east-1","identity_store_ids":["d-9067bcfc3c"]},"sensitive_values":{"arns":[false],"identity_store_ids":[false]}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"\u003e= 4.35.0"},"awscc":{"name":"awscc","full_name":"registry.terraform.io/hashicorp/awscc","version_constraint":"\u003e= 0.55.0"}},"root_module":{"outputs":{"account_assignment_data":{"expression":{"references":["local.flatten_account_assignment_data"]},"description":"Tuple containing account assignment data"},"principals_and_assignments":{"expression":{"references":["local.principals_and_their_account_assignments"]},"description":"Map containing account assignment data"}},"resources":[{"address":"aws_identitystore_group.sso_groups","mode":"managed","type":"aws_identitystore_group","name":"sso_groups","provider_config_key":"aws","expressions":{"description":{"references":["each.value.group_description","each.value"]},"display_name":{"references":["each.value.group_name","each.value"]},"identity_store_id":{"references":["local.sso_instance_id"]}},"schema_version":0,"for_each_expression":{"references":["var.sso_groups","var.sso_groups"]}},{"address":"aws_identitystore_group_membership.sso_group_membership","mode":"managed","type":"aws_identitystore_group_membership","name":"sso_group_membership","provider_config_key":"aws","expressions":{"group_id":{"references":["data.aws_identitystore_group.existing_sso_groups","each.key"]},"identity_store_id":{"references":["local.sso_instance_id"]},"member_id":{"references":["data.aws_identitystore_user.existing_sso_users","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.users_and_their_groups"]}},{"address":"aws_identitystore_user.sso_users","mode":"managed","type":"aws_identitystore_user","name":"sso_users","provider_config_key":"aws","expressions":{"addresses":[{"country":{"references":["each.value"]},"formatted":{"references":["each.value","each.value","each.value","each.value","each.value","each.value"]},"locality":{"references":["each.value"]},"postal_code":{"references":["each.value"]},"primary":{"references":["each.value"]},"region":{"references":["each.value"]},"street_address":{"references":["each.value"]},"type":{"references":["each.value"]}}],"display_name":{"references":["each.value.given_name","each.value","each.value.family_name","each.value"]},"emails":[{"primary":{"references":["each.value"]},"type":{"references":["each.value"]},"value":{"references":["each.value.email","each.value"]}}],"identity_store_id":{"references":["local.sso_instance_id"]},"locale":{"references":["each.value"]},"name":[{"family_name":{"references":["each.value.family_name","each.value"]},"formatted":{"references":["each.value","each.value.given_name","each.value","each.value.family_name","each.value"]},"given_name":{"references":["each.value.given_name","each.value"]},"honorific_prefix":{"references":["each.value"]},"honorific_suffix":{"references":["each.value"]},"middle_name":{"references":["each.value"]}}],"nickname":{"references":["each.value"]},"phone_numbers":[{"primary":{"references":["each.value"]},"type":{"references":["each.value"]},"value":{"references":["each.value"]}}],"preferred_language":{"references":["each.value"]},"profile_url":{"references":["each.value"]},"timezone":{"references":["each.value"]},"title":{"references":["each.value"]},"user_name":{"references":["each.value.user_name","each.value"]},"user_type":{"references":["each.value"]}},"schema_version":0,"for_each_expression":{"references":["var.sso_users","var.sso_users"]}},{"address":"aws_ssoadmin_account_assignment.account_assignment","mode":"managed","type":"aws_ssoadmin_account_assignment","name":"account_assignment","provider_config_key":"aws","expressions":{"instance_arn":{"references":["local.ssoadmin_instance_arn"]},"permission_set_arn":{"references":["data.aws_ssoadmin_permission_set.existing_permission_sets","each.key"]},"principal_id":{"references":["each.value.principal_type","each.value","data.aws_identitystore_group.identity_store_group","each.value.principal_name","each.value","data.aws_identitystore_user.identity_store_user","each.value.principal_name","each.value"]},"principal_type":{"references":["each.value.principal_type","each.value"]},"target_id":{"references":["each.value.account_id","each.value"]},"target_type":{"constant_value":"AWS_ACCOUNT"}},"schema_version":0,"for_each_expression":{"references":["local.principals_and_their_account_assignments"]}},{"address":"aws_ssoadmin_customer_managed_policy_attachment.pset_customer_managed_policy","mode":"managed","type":"aws_ssoadmin_customer_managed_policy_attachment","name":"pset_customer_managed_policy","provider_config_key":"aws","expressions":{"customer_managed_policy_reference":[{"name":{"references":["each.value.policy_name","each.value"]},"path":{"constant_value":"/"}}],"instance_arn":{"references":["local.ssoadmin_instance_arn"]},"permission_set_arn":{"references":["aws_ssoadmin_permission_set.pset","each.value.pset_name","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.pset_customer_managed_policy_maps"]}},{"address":"aws_ssoadmin_managed_policy_attachment.pset_aws_managed_policy","mode":"managed","type":"aws_ssoadmin_managed_policy_attachment","name":"pset_aws_managed_policy","provider_config_key":"aws","expressions":{"instance_arn":{"references":["local.ssoadmin_instance_arn"]},"managed_policy_arn":{"references":["each.value.policy_arn","each.value"]},"permission_set_arn":{"references":["aws_ssoadmin_permission_set.pset","each.value.pset_name","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.pset_aws_managed_policy_maps"]},"depends_on":["aws_ssoadmin_account_assignment.account_assignment"]},{"address":"aws_ssoadmin_permission_set.pset","mode":"managed","type":"aws_ssoadmin_permission_set","name":"pset","provider_config_key":"aws","expressions":{"description":{"references":["each.value"]},"instance_arn":{"references":["local.ssoadmin_instance_arn"]},"name":{"references":["each.key"]},"relay_state":{"references":["each.value"]},"session_duration":{"references":["each.value"]},"tags":{"references":["each.value"]}},"schema_version":0,"for_each_expression":{"references":["var.permission_sets"]}},{"address":"data.aws_identitystore_group.existing_sso_groups","mode":"data","type":"aws_identitystore_group","name":"existing_sso_groups","provider_config_key":"aws","expressions":{"alternate_identifier":[{"unique_attribute":[{"attribute_path":{"constant_value":"DisplayName"},"attribute_value":{"references":["each.value.group_name","each.value"]}}]}],"identity_store_id":{"references":["local.sso_instance_id"]}},"schema_version":0,"for_each_expression":{"references":["local.users_and_their_groups"]},"depends_on":["aws_identitystore_group.sso_groups"]},{"address":"data.aws_identitystore_group.identity_store_group","mode":"data","type":"aws_identitystore_group","name":"identity_store_group","provider_config_key":"aws","expressions":{"alternate_identifier":[{"unique_attribute":[{"attribute_path":{"constant_value":"DisplayName"},"attribute_value":{"references":["each.value"]}}]}],"identity_store_id":{"references":["local.sso_instance_id"]}},"schema_version":0,"for_each_expression":{"references":["local.account_assignments_for_groups"]},"depends_on":["aws_identitystore_group.sso_groups"]},{"address":"data.aws_identitystore_user.existing_sso_users","mode":"data","type":"aws_identitystore_user","name":"existing_sso_users","provider_config_key":"aws","expressions":{"alternate_identifier":[{"unique_attribute":[{"attribute_path":{"constant_value":"UserName"},"attribute_value":{"references":["each.value.user_name","each.value"]}}]}],"identity_store_id":{"references":["local.sso_instance_id"]}},"schema_version":0,"for_each_expression":{"references":["local.users_and_their_groups"]},"depends_on":["aws_identitystore_user.sso_users"]},{"address":"data.aws_identitystore_user.identity_store_user","mode":"data","type":"aws_identitystore_user","name":"identity_store_user","provider_config_key":"aws","expressions":{"alternate_identifier":[{"unique_attribute":[{"attribute_path":{"constant_value":"UserName"},"attribute_value":{"references":["each.value"]}}]}],"identity_store_id":{"references":["local.sso_instance_id"]}},"schema_version":0,"for_each_expression":{"references":["local.account_assignments_for_users"]},"depends_on":["aws_identitystore_user.sso_users"]},{"address":"data.aws_ssoadmin_instances.sso_instance","mode":"data","type":"aws_ssoadmin_instances","name":"sso_instance","provider_config_key":"aws","schema_version":0},{"address":"data.aws_ssoadmin_permission_set.existing_permission_sets","mode":"data","type":"aws_ssoadmin_permission_set","name":"existing_permission_sets","provider_config_key":"aws","expressions":{"instance_arn":{"references":["local.ssoadmin_instance_arn"]},"name":{"references":["each.value.permission_set","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.principals_and_their_account_assignments"]},"depends_on":["aws_ssoadmin_permission_set.pset"]}],"variables":{"account_assignments":{"default":{},"description":"List of maps containing mapping between user/group, permission set and assigned accounts list. See account_assignments description in README for more information about map values."},"permission_sets":{"default":{"AdministratorAccess":{"description":"Provides full access to AWS services and resources.","managed_policies":["arn:aws:iam::aws:policy/AdministratorAccess"],"session_duration":"PT2H"}},"description":"Map of maps containing Permission Set names as keys. See permission_sets description in README for information about map values."},"sso_groups":{"default":{},"description":"Names of the groups you wish to create in IAM Identity Center"},"sso_users":{"default":{},"description":"Names of the users you wish to create in IAM Identity Center"}}}},"relevant_attributes":[{"resource":"data.aws_ssoadmin_instances.sso_instance","attribute":["arns"]}]}
